(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{45:function(e,t,n){e.exports=n.p+"static/media/weightlifting-gif.b3731764.gif"},46:function(e,t,n){e.exports=n.p+"static/media/cardio2-gif.b92a3bff.gif"},51:function(e,t,n){e.exports=n.p+"static/media/bg-1.d85eef01.jpeg"},52:function(e,t,n){e.exports=n(93)},57:function(e,t,n){},74:function(e,t,n){},77:function(e,t){},86:function(e,t){},93:function(e,t,n){"use strict";n.r(t);var a=n(5),o=n.n(a),r=n(29),c=n.n(r),i=(n(57),n(2)),s=n.n(i),l=n(14),u=n(9),d=(n(61),n(16)),f=(n(74),n(36)),p=n(11),g=function(e){var t=e.message;return o.a.createElement(f.a,{className:"centeralign"},o.a.createElement("h3",null,"Disclaimer"),o.a.createElement(f.a,null,o.a.createElement("p",null,t)))},v=n(94),E=function(e){var t=e.web3State,n=e.connectWalletCb,r=Object(a.useState)(!1),c=Object(u.a)(r,2),i=c[0],s=c[1],l={connected:{fontStyle:"italic"},button:{backgroundColor:i?"#000000":"#D6DBDF",color:i?"#FFFFFF":"#000000"}};return t.connected?o.a.createElement("div",{style:l.connected}," ","Wallet Connected: ",t.account.slice(0,3),"...",t.account.slice(-3)):o.a.createElement(o.a.Fragment,null,o.a.createElement(v.a,{onMouseEnter:function(e){s(!0)},onMouseLeave:function(e){s(!1)},style:l.button,onClick:n,variant:"primary"},"Connect Wallet"))},m={IDLE:"idle",PENDING:"pending",VOTES_LOADING:"votes loading",VOTES_LOADED:"votes loaded",VOTE_ACTION_RESOLVED:"vote resolved",CONTRACTS_LOADED:"contract loaded",LOADING_CONTRACTS:"loading contracts",REJECTED:"rejected",FILTERED:"filtered"},h=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"getCardioVotes",outputs:[{internalType:"int256",name:"",type:"int256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWeightliftingVotes",outputs:[{internalType:"int256",name:"",type:"int256"}],stateMutability:"view",type:"function"},{inputs:[],name:"voteCardio",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"voteWeightlifting",outputs:[],stateMutability:"nonpayable",type:"function"}],b=n(20),O=n(7);function w(e,t){switch(console.log("votingStatusReducer --- render"),t.type){case m.IDLE:return console.log("votingStatusReducer --- status: idle"),{status:m.IDLE,votingState:null,error:null};case m.PENDING:return console.log("votingStatusReducer --- status: pending"),d.toast.warn("Placing vote...",{position:d.toast.POSITION.TOP_RIGHT,autoClose:5e3}),Object(O.a)({},e,t.votingState,{status:m.PENDING,error:null});case m.VOTES_LOADING:return console.log("votingStatusReducer --- status: votes loading"),Object(O.a)({},e,{status:m.VOTES_LOADING,error:null});case m.VOTE_ACTION_RESOLVED:return console.log("votingStatusReducer --- status: resolved"),d.toast.success("Vote successful. Please wait for vote count to refresh.",{position:d.toast.POSITION.TOP_RIGHT,autoClose:5e3}),Object(O.a)({},t.votingState,{status:m.VOTE_ACTION_RESOLVED,error:null});case m.VOTES_LOADED:return console.log("votingStatusReducer --- status: votes loaded"),Object(O.a)({},t.votingState,{status:m.VOTES_LOADED,error:null});case m.REJECTED:return console.log("VotingContextProvider --- reducer --- status: rejected",t.error),d.toast.error("Failed to fetch: "+t.error,{position:d.toast.POSITION.TOP_RIGHT,autoClose:1e4}),{status:m.REJECTED,data:null,error:t.error,endStatusCallback:e.endStatusCallback};default:throw console.log("VotingContextProvider --- reducer --- should not occur"),new Error("Unhandled action type: ".concat(t.type))}}var y=n(45),T=n.n(y),D=n(46),S=n.n(D),C={WEIGHTLIFTING:{text:"Weightlifting",value:"WEIGHTLIFTING",image:T.a},CARDIO:{text:"Cardio",value:"CARDIO",image:S.a}},I=o.a.createContext();function x(e){var t=e.web3State,n=Object(a.useState)(null),r=Object(u.a)(n,2),c=r[0],i=r[1],d=Object(a.useReducer)(w,{numWeightliftingVotes:0,numCardioVotes:0,status:m.IDLE,error:null}),p=Object(u.a)(d,2),g=p[0],v=p[1],E=C.WEIGHTLIFTING;function O(){return(O=Object(l.a)(s.a.mark(function e(t){var n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v({type:m.PENDING,votingState:g}),n=t.target.value===E.value,a=n?c.voteWeightlifting:c.voteCardio,e.next=5,a();case 5:e.sent.wait().then(function(e){v({type:m.VOTE_ACTION_RESOLVED,votingState:g}),y()});case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(){return T.apply(this,arguments)}function T(){return(T=Object(l.a)(s.a.mark(function e(){var t,n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v({type:m.VOTES_LOADING}),e.next=3,c.functions.getWeightliftingVotes();case 3:return t=e.sent,e.next=6,c.functions.getCardioVotes();case 6:n=e.sent,t[0]&&n[0]||console.error("Could not fetch vote counts"),a={numWeightliftingVotes:t[0],numCardioVotes:n[0]},v({votingState:a,type:m.VOTES_LOADED});case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(a.useEffect)(function(){function e(){return(e=Object(l.a)(s.a.mark(function e(){var n,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loading voting contract"),n=h,a=t.provider.getSigner(),e.next=5,new b.a.Contract("0x87aA67600E213900bBefa67eBA46afC352c2Fc69",n,a);case 5:(o=e.sent).connect(),i(o);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}t.provider&&function(){e.apply(this,arguments)}()},[t.provider]),Object(a.useEffect)(function(){function e(){return(e=Object(l.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}c&&(console.log("VotingContextProvider - votes initial load"),function(){e.apply(this,arguments)}())},[c]),o.a.createElement(I.Provider,{value:[g,v]},o.a.createElement(f.a,null,o.a.createElement(L,{voteDisabled:function(){return!t.connected||g.status!==m.VOTES_LOADED},votingState:g,web3State:t,voteCallback:function(e){return O.apply(this,arguments)}})),o.a.createElement(f.a,null,o.a.createElement(A,{votingState:g})))}var N=n(96);var k=function(e){var t=e.variant,n=e.voteDisabled,r=e.voteCallback,c=Object(a.useState)(!1),i=Object(u.a)(c,2),s=i[0],l=i[1],d={button:{backgroundColor:s?"#000000":"#D6DBDF",color:s?"#FFFFFF":"#000000"},image:{objectFit:"cover",borderRadius:40,height:"80px"},card:{width:"18rem"},header:{marginTop:"10px",marginBottom:"10px",fontFamily:"cursive",fontSize:"large"}};return o.a.createElement(N.a,{key:t.value,variant:"light",style:d.card,className:"mb-2 img-fluid"},o.a.createElement(N.a.Img,{src:t.image,style:d.image}),o.a.createElement(N.a.Header,{style:d.header},t.text),o.a.createElement(N.a.Body,null,o.a.createElement(v.a,{type:"submit",onClick:r,value:t.value,key:t.value,disabled:n,className:"btn btn-primary btn-block btn-lg",onMouseEnter:function(e){l(!0)},onMouseLeave:function(e){l(!1)},style:d.button,"aria-label":t.value},"Vote!")))},V=n(51),j=n.n(V),L=function(e){var t=e.votingState,n=e.web3State,r=e.voteCallback,c=C.WEIGHTLIFTING,i=C.CARDIO,s=Object(a.useState)([c,i]),l=Object(u.a)(s,1)[0],d=Object(a.useState)(!1),p=Object(u.a)(d,2),g=p[0],E=p[1];Object(a.useEffect)(function(){if(n&&t){var e=t.status!==m.VOTES_LOADED;E(e)}},[n.connected,t.status]);var h={cardDisplay:{display:"flex",justifyContent:"center"},card:{width:"18rem"},spacer:{width:"400px",display:"flex",justifyContent:"center"}};function b(){return l.map(function(e){return o.a.createElement("div",{key:e.value,style:h.spacer,img:j.a},o.a.createElement(k,{variant:e,voteDisabled:g,voteCallback:r}))})}return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,{style:h.cardDisplay},function(){var e;switch(t.status){case m.IDLE:return n.connected?o.a.createElement("div",null):o.a.createElement("div",null,"Connect wallet to place your vote");case m.PENDING:case m.VOTES_LOADING:return b();case m.REJECTED:throw new Error("Something went wrong. Please check connection.");case m.VOTE_ACTION_RESOLVED:return e="Refreshing vote results...",o.a.createElement(v.a,{variant:"link",id:"loader",className:"text-center"},e);case m.VOTES_LOADED:return b();default:console.log("default case - unexpected")}}()))},A=function(){var e=Object(a.useContext)(I),t=Object(u.a)(e,1)[0],n=t.numWeightliftingVotes,r=t.numCardioVotes;var c={loader:{color:"#FFFFFF"}};return o.a.createElement(function(){var e,a=function(e){return o.a.createElement(v.a,{style:c.loader,variant:"link",id:"loader",className:"text-center"},e)};switch(t.status){case m.IDLE:return o.a.createElement("div",null,"*** Place Your Vote! ***");case m.PENDING:return a("Updating votes...");case m.VOTES_LOADING:return a("Loading votes...");case m.REJECTED:throw new Error("Something went wrong. Please check connection.");case m.VOTE_ACTION_RESOLVED:return a("Refreshing vote results...");case m.VOTES_LOADED:return e=function(){console.log("determining winner");var e=C.WEIGHTLIFTING,t=C.CARDIO;return(n>r?e:n<r?t:{text:"Tied",value:"TIED"}).text}(),o.a.createElement("div",null,o.a.createElement("h2",null,"Leader: ",e,"!"),o.a.createElement("p",null,"Weightlifting Votes: ",n.toString()),o.a.createElement("p",null,"Cardio Votes: ",r.toString()));default:console.log("default case - unexpected")}},null)};n(21);function _(e){return e||(console.warn("Wallet not detected."),d.toast.warn("Wallet not detected.",{position:d.toast.POSITION.TOP_RIGHT,autoClose:5e3})),new b.a.providers.Web3Provider(e)}function F(){return R.apply(this,arguments)}function R(){return(R=Object(l.a)(s.a.mark(function e(){var t,n,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("walletIsConnected()"),e.prev=1,t=window,n=t.ethereum,console.log("ethereum object: ",n),n){e.next=8;break}a=!1,e.next=16;break;case 8:return console.log("getting account"),e.next=11,n.request({method:"eth_accounts"});case 11:return o=e.sent,console.log("accounts: ",o),a=Boolean(o.length>0),console.log("connected: ",a),e.abrupt("return",{connected:a,accounts:o});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0);case 21:case"end":return e.stop()}},e,null,[[1,18]])}))).apply(this,arguments)}function W(){return G.apply(this,arguments)}function G(){return(G=Object(l.a)(s.a.mark(function e(){var t,n,a,o,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("connectWallet()"),e.prev=1,t=window,n=t.ethereum){e.next=6;break}return console.warn("ethereum object not found"),e.abrupt("return");case 6:return e.next=8,n.request({method:"eth_requestAccounts"});case 8:if(a=e.sent,o=new b.a.providers.Web3Provider(n),r=0,!o){e.next=15;break}return e.next=14,o.getBalance(a[0]);case 14:r=e.sent;case 15:return e.abrupt("return",[n,o,a[0],r]);case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0);case 21:case"end":return e.stop()}},e,null,[[1,18]])}))).apply(this,arguments)}n(89).config();var P=function(){console.log("App component -- render");var e=Object(a.useState)({ethereum:null,account:null,provider:null,connected:!1,balance:0}),t=Object(u.a)(e,2),n=t[0],r=t[1];function c(){return(c=Object(l.a)(s.a.mark(function e(){var t,n,a,o,c,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W();case 2:t=e.sent,n=Object(u.a)(t,4),a=n[0],o=n[1],c=n[2],i=n[3],r({ethereum:a,provider:o,account:c,connected:!0,balance:i});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}Object(a.useEffect)(function(){console.log("App --- useEffect() -- render");var e=window.ethereum,t=_(e);function n(){return(n=Object(l.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",F());case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}(function(){return n.apply(this,arguments)})().then(function(n){var a=n.connected,o=n.accounts;if(a&&o){var c=a?o[0]:null;console.log("getting balance for: ",c),e.request({method:"eth_getBalance",params:[c,"latest"]}).then(function(n,o){console.log("result: ",n.toString());var i=n?p.a.from(n.toString()):0;console.log("state: ",{ethereum:e,provider:t,account:c,connected:a,balance:i}),r({ethereum:e,provider:t,account:c,connected:a,balance:i})})}})},[]);return o.a.createElement(o.a.Fragment,null,n&&o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement(f.a,{style:{display:"flex",justifyContent:"right"}},o.a.createElement(E,{web3State:n,connectWalletCb:function(){return c.apply(this,arguments)}})),o.a.createElement("h1",{className:"App-title"},"Blockchain Fitness Voting App")),o.a.createElement(d.ToastContainer,null),o.a.createElement(f.a,null,o.a.createElement(x,{web3State:n})),o.a.createElement("footer",{className:"App-footer",style:{marginTop:"20px"}},o.a.createElement(g,{message:"In order for this app to work successfully, you must have a Metamask or Web3 provider\n          account setup."}))))},B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function H(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}c.a.render(o.a.createElement(P,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/blockchain-fitness-voting",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/blockchain-fitness-voting","/service-worker.js");B?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):H(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):H(e)})}}()}},[[52,2,1]]]);
//# sourceMappingURL=main.f483bc5c.chunk.js.map